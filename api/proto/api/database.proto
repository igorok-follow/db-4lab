syntax = "proto3";

package database;

option go_package = "pkg/api";
import "google/api/annotations.proto";

service Database {
  rpc GetMaterials(Empty) returns (GetMaterialsResponse) {
    option (google.api.http) = { post: "/api/get/materials"; body: "*"; };
  };
  rpc GetDetails(Empty) returns (GetDetailsResponse) {
    option (google.api.http) = { post: "/api/get/details"; body: "*"; };
  };
  rpc GetProducts(Empty) returns(GetProductsResponse) {
    option (google.api.http) = { post: "/api/get/products"; body: "*"; };
  };
  rpc DeleteMaterials(DeleteMaterialsReq) returns (Empty) {
    option (google.api.http) = { post: "/api/delete/materials"; body: "*"; };
  };
  rpc DeleteDetails(DeleteDetailsReq) returns (Empty) {
    option (google.api.http) = { post: "/api/delete/details"; body: "*"; };
  };
  rpc DeleteProducts(DeleteProductsReq) returns(Empty) {
    option (google.api.http) = { post: "/api/delete/products"; body: "*"; };
  };

  rpc InsertMaterials(InsertMaterialsReq) returns (Empty) {
    option (google.api.http) = { post: "/api/insert/materials"; body: "*"; };
  };
  rpc InsertDetails(InsertDetailsReq) returns (Empty) {
    option (google.api.http) = { post: "/api/insert/details"; body: "*"; };
  };
  rpc InsertProducts(InsertProductsReq) returns(Empty) {
    option (google.api.http) = { post: "/api/insert/products"; body: "*"; };
  };

  rpc UpdateMaterials(UpdateMaterialsReq) returns (Empty) {
    option (google.api.http) = { post: "/api/update/materials"; body: "*"; };
  };
  rpc UpdateDetails(UpdateDetailsReq) returns (Empty) {
    option (google.api.http) = { post: "/api/update/details"; body: "*"; };
  };
  rpc UpdateProducts(UpdateProductsReq) returns(Empty) {
    option (google.api.http) = { post: "/api/update/products"; body: "*"; };
  };
}

message UpdateMaterialsReq {
  Material material = 1;
}

message UpdateDetailsReq {
  Detail detail = 1;
}

message UpdateProductsReq {
  Product product = 1;
}

message InsertMaterialsReq {
  Material material = 1;
}

message InsertDetailsReq {
  Detail detail = 1;
}

message InsertProductsReq {
  Product product = 1;
}

message DeleteMaterialsReq {
  string material_name = 1;
}

message DeleteDetailsReq {
  string detail_name = 1;
}

message DeleteProductsReq {
  int32 id = 1;
}

message Empty {}

message GetMaterialsResponse {
  repeated Material materials = 1;
  int32 count = 2;
}

message Material {
  string name = 1;
  float cost_per_gram = 2;
}

message GetDetailsResponse {
  repeated Detail details = 1;
  int32 count = 2;
}

message Detail {
  string name = 1;
  float weight = 2;
  string material_name = 3;
  int32 amount = 4;
}

message GetProductsResponse {
  repeated Product products = 1;
  int32 count = 2;
}

message Product {
  int32 id = 1;
  string name = 2;
  repeated Detail details = 3;
}